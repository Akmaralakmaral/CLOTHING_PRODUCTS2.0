@model CLOTHING_PRODUCTS.Models.Ingredient

<h2>Ingredients</h2>

<select id="finishedProductDropdown">
    <option value="">Select Finished Product</option>
    @foreach (var product in ViewBag.FinishedProducts)
    {
        <option value="@product.FinishedProductId">@product.Name</option>
    }
</select>

<div id="ingredientDetails" style="display:none;">
    <h3>Raw Materials and Quantities</h3>
    <table>
        <thead>
            <tr>
                <th>Raw Material</th>
                <th>Quantity</th>
            </tr>
        </thead>
        <tbody id="ingredientList">
            <!-- Raw material details will be displayed here -->
        </tbody>
    </table>
</div>

@section Scripts {
    <script>
        document.getElementById('finishedProductDropdown').addEventListener('change', function () {
            var selectedProductId = this.value;
            if (selectedProductId !== "") {
                // Make an AJAX request to get ingredient details
                fetch(`/Ingredient/GetIngredients/${selectedProductId}`)
                    .then(response => response.json())
                    .then(data => {
                        // Update the ingredient details in the table
                        var ingredientList = document.getElementById('ingredientList');
                        ingredientList.innerHTML = "";

                        data.forEach(function (ingredient) {
                            var row = document.createElement('tr');
                            var rawMaterialCell = document.createElement('td');
                            rawMaterialCell.textContent = ingredient.rawMaterialName;
                            row.appendChild(rawMaterialCell);

                            var quantityCell = document.createElement('td');
                            quantityCell.textContent = ingredient.quantity;
                            row.appendChild(quantityCell);

                            ingredientList.appendChild(row);
                        });

                        // Show the ingredient details section
                        document.getElementById('ingredientDetails').style.display = 'block';
                    });
            } else {
                // Hide the ingredient details section
                document.getElementById('ingredientDetails').style.display = 'none';
            }
        });
    </script>
}
